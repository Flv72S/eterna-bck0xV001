(()=>{var e={};e.id=495,e.ids=[495,888,660],e.modules={2502:(e,s,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(s),r.d(s,{config:()=>g,default:()=>u,getServerSideProps:()=>h,getStaticPaths:()=>x,getStaticProps:()=>p,reportWebVitals:()=>j,routeModule:()=>S,unstable_getServerProps:()=>f,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>N});var l=r(3101),i=r(7873),t=r(8222),n=r(8486),o=r.n(n),c=r(6452),m=r(8606),d=e([m]);m=(d.then?(await d)():d)[0];let u=(0,t.l)(m,"default"),p=(0,t.l)(m,"getStaticProps"),x=(0,t.l)(m,"getStaticPaths"),h=(0,t.l)(m,"getServerSideProps"),g=(0,t.l)(m,"config"),j=(0,t.l)(m,"reportWebVitals"),N=(0,t.l)(m,"unstable_getStaticProps"),v=(0,t.l)(m,"unstable_getStaticPaths"),b=(0,t.l)(m,"unstable_getStaticParams"),f=(0,t.l)(m,"unstable_getServerProps"),y=(0,t.l)(m,"unstable_getServerSideProps"),S=new l.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/register",pathname:"/register",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:m});a()}catch(e){a(e)}})},6452:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>l});var a=r(997);function l({Component:e,pageProps:s}){return a.jsx(e,{...s})}r(2526)},8606:(e,s,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(s),r.d(s,{default:()=>p});var l=r(997),i=r(6689),t=r(5641),n=r(5984),o=r.n(n),c=r(7193),m=r(7644),d=r.n(m),u=e([t]);t=(u.then?(await u)():u)[0];let x=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),h=e=>{if(!e)return"";let s=e.replace(/\D/g,"");return s.length<=3?s:s.length<=6?`${s.slice(0,3)} ${s.slice(3)}`:`${s.slice(0,3)} ${s.slice(3,6)} ${s.slice(6,10)}`};function p(){let{register:e,handleSubmit:s,formState:{errors:r},watch:a,setValue:n}=(0,t.useForm)({defaultValues:{version:"free",name:"",surname:"",email:"",phone:"",phonePrefix:"+39",pin:"123456",token:"123456",seriale_gioiello:"123456"}}),[m,u]=(0,i.useState)(!1),[p,g]=(0,i.useState)(!1),j=a("version"),N=(0,c.useRouter)(),v=async()=>{g(!0);try{alert("Il tuo dispositivo non supporta la lettura NFC")}catch(e){console.error("Errore nella lettura NFC:",e),alert("Errore nella lettura NFC")}finally{g(!1)}},b=async e=>{if(e){u(!0);try{console.log("Invio dati di registrazione:",e);let s=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,pin:e.pin,version:e.version,seriale_gioiello:e.seriale_gioiello,phone:e.phone,nome:e.name,cognome:e.surname,token:e.token})});console.log("Risposta ricevuta:",s);let r=s.headers.get("content-type");if(console.log("Content-Type della risposta:",r),!r||!r.includes("application/json")){let e=await s.text();throw console.error("Risposta non JSON:",e),Error("La risposta del server non \xe8 nel formato JSON atteso")}let a=await s.json();if(console.log("Risultato JSON:",a),!s.ok)throw Error(a.message||"Errore nella registrazione");alert("Registrazione completata con successo"),N.push("/login")}catch(e){console.error("Errore nella registrazione:",e),alert(e instanceof Error?e.message:"Errore nella registrazione")}finally{u(!1)}}};return l.jsx("div",{className:"bg-auth",children:(0,l.jsxs)("div",{className:"flex h-screen w-full",children:[l.jsx("div",{className:"bg-image",children:l.jsx("div",{className:"bg-image-content",children:l.jsx(d(),{src:"/images/auth/register-bg.jpg",alt:"Register Background",fill:!0,className:"object-cover",priority:!0})})}),l.jsx("div",{className:"flex w-full items-center justify-center lg:w-1/2",children:(0,l.jsxs)("div",{className:"container",children:[l.jsx("div",{className:"mb-8 text-center",children:l.jsx("h2",{className:"title",children:"Registrazione Utente Privato"})}),l.jsx("form",{onSubmit:s(b),className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"label",children:"Nome"}),l.jsx("input",{...e("name",{required:!0}),type:"text",className:"form-input"}),r.name&&l.jsx("p",{className:"error-message",children:"Il nome \xe8 obbligatorio"})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"label",children:"Cognome"}),l.jsx("input",{...e("surname",{required:!0}),type:"text",className:"form-input"}),r.surname&&l.jsx("p",{className:"error-message",children:"Il cognome \xe8 obbligatorio"})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[l.jsx("label",{className:"label",children:"Email"}),l.jsx("input",{...e("email",{required:!0,validate:x}),type:"email",className:"form-input"}),r.email&&l.jsx("p",{className:"error-message",children:"validate"===r.email.type?"Inserisci un indirizzo email valido":"L'email \xe8 obbligatoria"})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[l.jsx("label",{className:"label",children:"Telefono"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("select",{...e("phonePrefix"),className:"form-select w-24",children:[l.jsx("option",{value:"+39",children:"+39"}),l.jsx("option",{value:"+33",children:"+33"}),l.jsx("option",{value:"+49",children:"+49"}),l.jsx("option",{value:"+44",children:"+44"}),l.jsx("option",{value:"+34",children:"+34"})]}),l.jsx("input",{...e("phone",{onChange:e=>{e.target.value=h(e.target.value)}}),type:"tel",className:"form-input flex-1"})]})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[l.jsx("label",{className:"label",children:"PIN (6 cifre)"}),l.jsx("input",{...e("pin",{required:!0,minLength:6,maxLength:6,pattern:/^[0-9]{6}$/}),type:"password",className:"form-input"}),r.pin&&l.jsx("p",{className:"error-message",children:"Il PIN deve essere di 6 cifre numeriche"})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[l.jsx("label",{className:"label",children:"Versione"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsxs)("label",{className:"inline-flex items-center",children:[l.jsx("input",{type:"radio",...e("version",{required:!0}),value:"free",className:"form-radio"}),l.jsx("span",{className:"ml-2",children:"Free"})]}),(0,l.jsxs)("label",{className:"inline-flex items-center",children:[l.jsx("input",{type:"radio",...e("version",{required:!0}),value:"premium",className:"form-radio"}),l.jsx("span",{className:"ml-2",children:"Premium"})]})]})]}),"premium"===j&&(0,l.jsxs)("div",{className:"col-span-2",children:[l.jsx("label",{className:"label",children:"Seriale Gioiello"}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"text",...e("seriale_gioiello",{required:"Il seriale del gioiello \xe8 obbligatorio per la versione Premium",pattern:{value:/^[0-9A-F]{8}$/,message:"Il seriale deve essere un codice esadecimale di 8 caratteri"}}),className:"form-input",placeholder:"Inserisci il seriale del gioiello"}),l.jsx("button",{type:"button",onClick:v,disabled:p,className:"btn btn-primary",children:p?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Lettura in corso..."]}):"Leggi NFC"})]}),r.seriale_gioiello&&l.jsx("p",{className:"error-message",children:r.seriale_gioiello.message})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[l.jsx("label",{className:"label",children:"Token"}),l.jsx("input",{...e("token",{required:!0}),type:"text",className:"form-input"}),r.token&&l.jsx("p",{className:"error-message",children:"Il token \xe8 obbligatorio"})]}),l.jsx("div",{className:"col-span-2",children:l.jsx("button",{type:"submit",disabled:m,className:"btn btn-primary w-full",children:m?"Registrazione in corso...":"Registrati"})})]})}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("div",{className:"relative",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:"w-full border-t border-gray-300"})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Oppure"})})]}),l.jsx("div",{className:"mt-6",children:l.jsx(o(),{href:"/login",className:"btn btn-outline-primary w-full",children:"Accedi"})})]})]})})]})})}a()}catch(e){a(e)}})},2526:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},5641:e=>{"use strict";e.exports=import("react-hook-form")}};var s=require("../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),a=s.X(0,[486,760,193,644],()=>r(2502));module.exports=a})();