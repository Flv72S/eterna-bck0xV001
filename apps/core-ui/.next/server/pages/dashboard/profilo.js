(()=>{var e={};e.id=768,e.ids=[768,888,660],e.modules={6266:(e,t,s)=>{e.exports={...s(Object(function(){var e=Error("Cannot find module '.prisma/client/default'");throw e.code="MODULE_NOT_FOUND",e}()))}},5360:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>v,default:()=>f,getServerSideProps:()=>b,getStaticPaths:()=>p,getStaticProps:()=>g,reportWebVitals:()=>j,routeModule:()=>k,unstable_getServerProps:()=>_,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>y});var r={};s.r(r),s.d(r,{default:()=>h});var a=s(3101),n=s(7873),o=s(8222),i=s(8486),l=s.n(i),d=s(6452),c=s(997),m=s(8539),u=s(2667),x=s(6689);function h(){let{user:e}=(0,u.aF)(),[t,s]=(0,x.useState)(!1),[r,a]=(0,x.useState)({nome:e?.nome||"",cognome:e?.cognome||"",email:e?.email||"",phone:e?.phone||""}),n=e=>{let{name:t,value:s}=e.target;a(e=>({...e,[t]:s}))},o=async e=>{e.preventDefault(),s(!1)};return c.jsx(m.Z,{children:(0,c.jsxs)("div",{className:"max-w-7xl mx-auto",children:[c.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Il tuo profilo"}),c.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Gestisci le tue informazioni personali"}),c.jsx("div",{className:"mt-8 bg-white shadow rounded-lg",children:c.jsx("div",{className:"px-4 py-5 sm:p-6",children:t?(0,c.jsxs)("form",{onSubmit:o,className:"space-y-6",children:[(0,c.jsxs)("div",{children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Modifica informazioni personali"}),(0,c.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[(0,c.jsxs)("div",{className:"sm:col-span-3",children:[c.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-700",children:"Nome"}),c.jsx("input",{type:"text",name:"nome",id:"nome",value:r.nome,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,c.jsxs)("div",{className:"sm:col-span-3",children:[c.jsx("label",{htmlFor:"cognome",className:"block text-sm font-medium text-gray-700",children:"Cognome"}),c.jsx("input",{type:"text",name:"cognome",id:"cognome",value:r.cognome,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,c.jsxs)("div",{className:"sm:col-span-4",children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),c.jsx("input",{type:"email",name:"email",id:"email",value:r.email,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,c.jsxs)("div",{className:"sm:col-span-4",children:[c.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Telefono"}),c.jsx("input",{type:"tel",name:"phone",id:"phone",value:r.phone,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:()=>s(!1),className:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Annulla"}),c.jsx("button",{type:"submit",className:"bg-indigo-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Salva modifiche"})]})]}):(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Informazioni personali"}),(0,c.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[(0,c.jsxs)("div",{className:"sm:col-span-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),c.jsx("div",{className:"mt-1 text-sm text-gray-900",children:e?.nome})]}),(0,c.jsxs)("div",{className:"sm:col-span-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cognome"}),c.jsx("div",{className:"mt-1 text-sm text-gray-900",children:e?.cognome})]}),(0,c.jsxs)("div",{className:"sm:col-span-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),c.jsx("div",{className:"mt-1 text-sm text-gray-900",children:e?.email})]}),(0,c.jsxs)("div",{className:"sm:col-span-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefono"}),c.jsx("div",{className:"mt-1 text-sm text-gray-900",children:e?.phone})]})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"button",onClick:()=>s(!0),className:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Modifica"})})]})})})]})})}let f=(0,o.l)(r,"default"),g=(0,o.l)(r,"getStaticProps"),p=(0,o.l)(r,"getStaticPaths"),b=(0,o.l)(r,"getServerSideProps"),v=(0,o.l)(r,"config"),j=(0,o.l)(r,"reportWebVitals"),y=(0,o.l)(r,"unstable_getStaticProps"),N=(0,o.l)(r,"unstable_getStaticPaths"),w=(0,o.l)(r,"unstable_getStaticParams"),_=(0,o.l)(r,"unstable_getServerProps"),S=(0,o.l)(r,"unstable_getServerSideProps"),k=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/dashboard/profilo",pathname:"/dashboard/profilo",bundlePath:"",filename:""},components:{App:d.default,Document:l()},userland:r})},8539:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var r=s(997),a=s(6689),n=s(5984),o=s.n(n),i=s(7193);function l({children:e}){let[t,s]=(0,a.useState)(!1),n=(0,i.useRouter)(),{user:l,loading:d}=function(){let[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(!0);return(0,i.useRouter)(),{user:e,loading:s}}();if(d)return r.jsx("div",{children:"Caricamento..."});if(!l)return n.push("/login"),null;let c="admin"===l.ruolo,m=[{name:"Dashboard",href:"/dashboard",icon:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"},{name:"Profilo",href:"/dashboard/profile",icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},..."professionista"===l.ruolo?[{name:"Appuntamenti",href:"/dashboard/appointments",icon:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"},{name:"Documenti",href:"/dashboard/documents",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}]:[],...c?[{name:"Utenti",href:"/dashboard/users",icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"},{name:"Professionisti",href:"/dashboard/professionals",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"}]:[]];return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[r.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform ${t?"translate-x-0":"-translate-x-full"} transition-transform duration-200 ease-in-out lg:translate-x-0 lg:static lg:inset-0`,children:(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[r.jsx("div",{className:"flex items-center justify-center h-16 px-4 bg-indigo-600",children:r.jsx("span",{className:"text-white text-xl font-bold",children:"Eterna Dashboard"})}),r.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1",children:m.map(e=>(0,r.jsxs)(o(),{href:e.href,className:`flex items-center px-2 py-2 text-sm font-medium rounded-md ${n.pathname===e.href?"bg-indigo-100 text-indigo-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[r.jsx("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:e.icon})}),e.name]},e.name))}),r.jsx("div",{className:"p-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:(0,r.jsxs)("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white",children:[l.nome?.[0],l.cognome?.[0]]})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[l.nome," ",l.cognome]}),r.jsx("p",{className:"text-xs text-gray-500",children:l.ruolo})]})]})})]})}),(0,r.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[r.jsx("div",{className:"sticky top-0 z-10 flex items-center justify-between h-16 px-4 bg-white border-b border-gray-200 lg:hidden",children:(0,r.jsxs)("button",{type:"button",className:"text-gray-500 hover:text-gray-600",onClick:()=>s(!t),children:[r.jsx("span",{className:"sr-only",children:"Apri menu"}),r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]})}),r.jsx("main",{className:"flex-1 p-4",children:e})]})]})}},6452:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(997);function a({Component:e,pageProps:t}){return r.jsx(e,{...t})}s(2526)},2526:()=>{},3438:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateOtp=o;let a=s(4770),n=r(s(3162));async function o(e){let t=""+(0,a.randomInt)(1e5,999999),s=new Date(Date.now()+3e5);return await n.default.otps.create({data:{userId:e,code:t,expiresAt:s}}),t}},2667:(e,t,s)=>{"use strict";t.aF=void 0,s(3438),s(4634),s(3465);let r=s(3022);Object.defineProperty(t,"aF",{enumerable:!0,get:function(){return r.useUser}})},3465:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.login=o;let a=r(s(9344)),n=r(s(3162));async function o(e,t){let s=await n.default.users.findUnique({where:{email:e}});if(!s||s.pin!==t)return null;let r=a.default.sign({userId:s.id,role:s.role},process.env.JWT_SECRET,{expiresIn:"1h"});return await n.default.sessions.create({data:{userId:s.id,token:r,expiresAt:new Date(Date.now()+36e5)}}),r}},3022:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useUser=function(){let[e,t]=(0,r.useState)(null),[s,n]=(0,r.useState)(!0),o=(0,a.useRouter)();return(0,r.useEffect)(()=>{let e=localStorage.getItem("token");if(!e){n(!1);return}(async()=>{try{let s=await fetch("/api/auth/me",{headers:{Authorization:`Bearer ${e}`}});if(s.ok){let e=await s.json();t(e)}else localStorage.removeItem("token"),o.push("/login")}catch(e){console.error("Error fetching user:",e),localStorage.removeItem("token"),o.push("/login")}finally{n(!1)}})()},[o]),{user:e,loading:s}};let r=s(6689),a=s(7193)},4634:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verifyOtp=n;let a=r(s(3162));async function n(e,t){let s=await a.default.otps.findFirst({where:{userId:e,code:t,used:!1}});return!(!s||new Date(s.expiresAt)<new Date)&&(await a.default.otps.update({where:{id:s.id},data:{used:!0}}),!0)}},3162:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=new(s(6266)).PrismaClient;t.default=r},9344:e=>{"use strict";e.exports=require("jsonwebtoken")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},4770:e=>{"use strict";e.exports=require("crypto")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[486,760,193],()=>s(5360));module.exports=r})();